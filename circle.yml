checkout:
    pre:
        - sudo apt-add-repository -y 'deb http://llvm.org/apt/precise/ llvm-toolchain-precise-3.4 main'
        - wget -q -O - http://llvm.org/apt/llvm-snapshot.gpg.key | sudo apt-key add -
        - sudo apt-get update
        - sudo apt-get install clang-3.4 

    post:
        - cd ..; hg clone https://hg.mozilla.org/projects/nspr

        # Build with Clang because GCC isn't getting -Werror.
        - CC=clang-3.4 CCC=clang++-3.4 make nss_build_all

        # Build with GCC as well.
        - make nss_build_all

test:
    override:
        # Test with GCC
        - cd tests; NSS_TESTS=ssl_gtests NSS_CYCLES=standard ./all.sh

machine:
    environment:
        { USE_64: 1,
          NSS_ENABLE_TLS_1_3: 1,
          NSS_BUILD_GTESTS: 1,
          HOST: 'nss-tests'
        }
    hosts:


